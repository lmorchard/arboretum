!function e(t,r,n){function a(i,s){if(!r[i]){if(!t[i]){var u="function"==typeof require&&require;if(!s&&u)return u(i,!0);if(o)return o(i,!0);var l=new Error("Cannot find module '"+i+"'");throw l.code="MODULE_NOT_FOUND",l}var c=r[i]={exports:{}};t[i][0].call(c.exports,function(e){var r=t[i][1][e];return a(r?r:e)},c,c.exports,e,t,r,n)}return r[i].exports}for(var o="function"==typeof require&&require,i=0;i<n.length;i++)a(n[i]);return a}({"/Users/lmorchard/devel/arboretum/src/index.js":[function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}function a(e){return e&&e.__esModule?e:{"default":e}}var o=e("react"),i=a(o),s=e("react-dom"),u=a(s),l=e("immutable"),c=a(l),d=e("react-redux"),p=e("redux"),f=e("./lib/actions"),h=(n(f),e("./lib/reducers")),m=a(h),v=e("./lib/components"),E=function(e){return function(t){return function(r){console.log("dispatching",r);var n=t(r);return console.log("next state",e.getState()),n}}},g=(0,p.applyMiddleware)(E)(p.createStore),O=g(m["default"],{nodes:c["default"].fromJS([{title:"alpha"},{title:"beta",children:[{title:"foo"},{title:"bar",children:[{title:"quux"},{title:"xyzzy"}]},{title:"baz"}]},{title:"gamma"}])});window.store=O,u["default"].render(i["default"].createElement(d.Provider,{store:O},i["default"].createElement(v.Outline,null)),document.getElementById("app"))},{"./lib/actions":"/Users/lmorchard/devel/arboretum/src/lib/actions.js","./lib/components":"/Users/lmorchard/devel/arboretum/src/lib/components.js","./lib/reducers":"/Users/lmorchard/devel/arboretum/src/lib/reducers.js",immutable:"immutable",react:"react","react-dom":"react-dom","react-redux":"react-redux",redux:"redux"}],"/Users/lmorchard/devel/arboretum/src/lib/actions.js":[function(e,t,r){"use strict";function n(e,t,r){return{type:s,node:e,path:t,before:r}}function a(e){return{type:u,path:e}}function o(e,t,r){return{type:i,fromPath:e,toPath:t,position:r}}Object.defineProperty(r,"__esModule",{value:!0}),r.insertNode=n,r.deleteNode=a,r.moveNode=o;var i=r.MOVE_NODE="MOVE_NODE",s=r.INSERT_NODE="INSERT_NODE",u=r.DELETE_NODE="DELETE_NODE";r.CHANGE_NODE_TITLE="CHANGE_NODE_TITLE",r.MovePositions={BEFORE:"BEFORE",AFTER:"AFTER",ADOPT:"ADOPT"}},{}],"/Users/lmorchard/devel/arboretum/src/lib/components.js":[function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}function a(e){return e&&e.__esModule?e:{"default":e}}function o(e){e.stopPropagation(),e.preventDefault()}function i(e,t){Object.keys(t).forEach(function(r){e.dataTransfer.setData("x-meta/"+r+"/"+t[r],t[r])})}function s(e){for(var t={},r=e.dataTransfer.types,n=0;n<r.length;n++){var a=r[n].split("/");"x-meta"==a[0]&&(t[a[1]]=a[2])}return t}Object.defineProperty(r,"__esModule",{value:!0}),r.OutlineNode=r.OutlineTree=r.Outline=void 0;var u=e("react"),l=a(u),c=e("react-dom"),d=(a(c),e("react-redux")),p=e("./actions"),f=n(p),h=(r.Outline=(0,d.connect)(function(e){return{nodes:e.nodes.toJS()}})(function(e){var t=e.dispatch,r=e.nodes;return l["default"].createElement(h,{dispatch:t,nodes:r,path:""})}),r.OutlineTree=function(e){var t=e.dispatch,r=e.nodes,n=e.path;return l["default"].createElement("ul",{className:"outline"},r.map(function(e,r){return l["default"].createElement(m,{dispatch:t,node:e,key:r,index:r,path:n+r})}))}),m=r.OutlineNode=l["default"].createClass({displayName:"OutlineNode",getInitialState:function(){return{dragging:!1,positionPreview:null}},render:function(){var e=this.props,t=e.dispatch,r=e.node,n=e.path,a=this.state.positionPreview,o={padding:"0.125em",backgroundColor:a==f.MovePositions.ADOPT?"#ccc":"transparent",borderTop:a==f.MovePositions.BEFORE?"1px solid #ccc":"1px solid transparent",borderBottom:a==f.MovePositions.AFTER?"1px solid #ccc":"1px solid transparent",opacity:this.state.dragging?.5:1},i={};return l["default"].createElement("li",{className:"outline-node",style:o,draggable:!0,onDragStart:this.onDragStart,onDragEnter:this.onDragEnter,onDragOver:this.onDragOver,onDragLeave:this.onDragLeave,onDragEnd:this.onDragEnd,onDrop:this.onDrop.bind(this,t)},l["default"].createElement("button",{style:{margin:"0 0.5em"},onClick:this.onDelete.bind(this,t)},"X"),l["default"].createElement("span",{className:"title",style:i},r.title),r.children?l["default"].createElement(h,{dispatch:t,path:n+".children.",nodes:r.children}):null)},onDragStart:function(e){var t=this.props,r=t.path,n=t.node;i(e,{path:r}),e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("text/plain",JSON.stringify({path:r,node:n})),this.setState({dragging:!0}),e.stopPropagation()},onDragEnter:function(e){var t=s(e),r=t.path;return r!=this.props.path&&(e.dataTransfer.dropEffect="move"),o(e)},onDragOver:function(e){var t=s(e),r=t.path;if(0!==this.props.path.indexOf(r)){var n=e.target.getBoundingClientRect(),a=e.clientX>n.left+50?"ADOPT":e.clientY<n.top+n.height/2?"BEFORE":"AFTER";this.setState({positionPreview:f.MovePositions[a]})}return o(e)},onDragLeave:function(e){return this.setState({positionPreview:null}),o(e)},onDragEnd:function(e){return this.setState({dragging:!1}),o(e)},onDrop:function(e,t){var r=s(t),n=r.path,a=JSON.parse(t.dataTransfer.getData("text"));return 0!==this.props.path.indexOf(n)&&e(f.moveNode(a.path,this.props.path,this.state.positionPreview)),this.setState({positionPreview:null}),o(t)},onDelete:function(e,t){return e(f.deleteNode(this.props.path)),o(t)}})},{"./actions":"/Users/lmorchard/devel/arboretum/src/lib/actions.js",react:"react","react-dom":"react-dom","react-redux":"react-redux"}],"/Users/lmorchard/devel/arboretum/src/lib/reducers.js":[function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}function a(e){return e&&e.__esModule?e:{"default":e}}function o(){var e=arguments.length<=0||void 0===arguments[0]?[]:arguments[0],t=arguments[1];switch(t.type){case c.INSERT_NODE:return e;case c.DELETE_NODE:return e.deleteIn(t.path.split("."));case c.MOVE_NODE:var r=t.position,n=t.fromPath.split("."),a=t.toPath.split("."),o=e.getIn(n);return e=e.setIn(n,null),r==c.MovePositions.ADOPT?e=e.updateIn(a,function(e){return e.has("children")?e.update("children",function(e){return e.unshift(o)}):e.set("children",u["default"].List([o]))}):!function(){var t=parseInt(a.pop())+(r==c.MovePositions.BEFORE)?0:1;e=e.updateIn(a,function(e){return e.splice(t,0,o)})}(),e.update(d);case c.CHANGE_NODE_TITLE:return e;default:return e}}Object.defineProperty(r,"__esModule",{value:!0});var i=e("redux"),s=e("immutable"),u=a(s),l=e("./actions"),c=n(l),d=function p(e){return e.filter(function(e){return null!==e}).map(function(e){return e.has("children")?e.update("children",p):e})};r["default"]=(0,i.combineReducers)({nodes:o})},{"./actions":"/Users/lmorchard/devel/arboretum/src/lib/actions.js",immutable:"immutable",redux:"redux"}]},{},["/Users/lmorchard/devel/arboretum/src/index.js"]);