!function e(t,n,r){function a(i,u){if(!n[i]){if(!t[i]){var s="function"==typeof require&&require;if(!u&&s)return s(i,!0);if(o)return o(i,!0);var l=new Error("Cannot find module '"+i+"'");throw l.code="MODULE_NOT_FOUND",l}var c=n[i]={exports:{}};t[i][0].call(c.exports,function(e){var n=t[i][1][e];return a(n?n:e)},c,c.exports,e,t,n,r)}return n[i].exports}for(var o="function"==typeof require&&require,i=0;i<r.length;i++)a(r[i]);return a}({1:[function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function a(e){return e&&e.__esModule?e:{"default":e}}var o=e("react"),i=a(o),u=e("react-dom"),s=a(u),l=e("immutable"),c=a(l),d=e("react-redux"),p=e("redux"),f=e("./lib/actions"),h=(r(f),e("./lib/reducers")),E=a(h),v=e("./lib/components"),m=function(e){return function(t){return function(n){console.log("dispatching",n);var r=t(n);return console.log("next state",e.getState()),r}}},g=(0,p.applyMiddleware)(m)(p.createStore),O=g(E["default"],{nodes:c["default"].fromJS([{title:"alpha"},{title:"beta",children:[{title:"foo"},{title:"bar",children:[{title:"quux"},{title:"xyzzy"}]},{title:"baz"}]},{title:"gamma"}])});window.store=O,s["default"].render(i["default"].createElement(d.Provider,{store:O},i["default"].createElement(v.Outline,null)),document.getElementById("app"))},{"./lib/actions":2,"./lib/components":3,"./lib/reducers":4,immutable:"immutable",react:"react","react-dom":"react-dom","react-redux":"react-redux",redux:"redux"}],2:[function(e,t,n){"use strict";function r(e,t,n){return{type:u,node:e,path:t,before:n}}function a(e){return{type:s,path:e}}function o(e,t,n){return{type:i,fromPath:e,toPath:t,position:n}}Object.defineProperty(n,"__esModule",{value:!0}),n.insertNode=r,n.deleteNode=a,n.moveNode=o;var i=n.MOVE_NODE="MOVE_NODE",u=n.INSERT_NODE="INSERT_NODE",s=n.DELETE_NODE="DELETE_NODE";n.CHANGE_NODE_TITLE="CHANGE_NODE_TITLE",n.MovePositions={BEFORE:"BEFORE",AFTER:"AFTER",ADOPT:"ADOPT"}},{}],3:[function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function a(e){return e&&e.__esModule?e:{"default":e}}function o(e){e.stopPropagation(),e.preventDefault()}function i(e,t){Object.keys(t).forEach(function(n){e.dataTransfer.setData("x-meta/"+n+"/"+t[n],t[n])})}function u(e){for(var t={},n=e.dataTransfer.types,r=0;r<n.length;r++){var a=n[r].split("/");"x-meta"==a[0]&&(t[a[1]]=a[2])}return t}Object.defineProperty(n,"__esModule",{value:!0}),n.OutlineNode=n.OutlineTree=n.Outline=void 0;var s=e("react"),l=a(s),c=e("react-dom"),d=(a(c),e("react-redux")),p=e("./actions"),f=r(p),h=(n.Outline=(0,d.connect)(function(e){return{nodes:e.nodes.toJS()}})(function(e){var t=e.dispatch,n=e.nodes;return l["default"].createElement(h,{dispatch:t,nodes:n,path:""})}),n.OutlineTree=function(e){var t=e.dispatch,n=e.nodes,r=e.path;return l["default"].createElement("ul",{className:"outline"},n.map(function(e,n){return l["default"].createElement(E,{dispatch:t,node:e,key:n,index:n,path:r+n})}))}),E=n.OutlineNode=l["default"].createClass({displayName:"OutlineNode",getInitialState:function(){return{dragging:!1,positionPreview:null}},render:function(){var e=this.props,t=e.dispatch,n=e.node,r=e.path,a=this.state.positionPreview,o={padding:"0.125em",backgroundColor:a==f.MovePositions.ADOPT?"#ccc":"transparent",borderTop:a==f.MovePositions.BEFORE?"1px solid #ccc":"1px solid transparent",borderBottom:a==f.MovePositions.AFTER?"1px solid #ccc":"1px solid transparent",opacity:this.state.dragging?.5:1},i={};return l["default"].createElement("li",{className:"outline-node",style:o,draggable:!0,onDragStart:this.onDragStart,onDragEnter:this.onDragEnter,onDragOver:this.onDragOver,onDragLeave:this.onDragLeave,onDragEnd:this.onDragEnd,onDrop:this.onDrop.bind(this,t)},l["default"].createElement("button",{style:{margin:"0 0.5em"},onClick:this.onDelete.bind(this,t)},"X"),l["default"].createElement("span",{className:"title",style:i},n.title),n.children?l["default"].createElement(h,{dispatch:t,path:r+".children.",nodes:n.children}):null)},onDragStart:function(e){var t=this.props,n=t.path,r=t.node;i(e,{path:n}),e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("text/plain",JSON.stringify({path:n,node:r})),this.setState({dragging:!0}),e.stopPropagation()},onDragEnter:function(e){var t=u(e),n=t.path;return n!=this.props.path&&(e.dataTransfer.dropEffect="move"),o(e)},onDragOver:function(e){var t=u(e),n=t.path;if(0!==this.props.path.indexOf(n)){var r=e.target.getBoundingClientRect(),a=e.clientX>r.left+50?"ADOPT":e.clientY<r.top+r.height/2?"BEFORE":"AFTER";this.setState({positionPreview:f.MovePositions[a]})}return o(e)},onDragLeave:function(e){return this.setState({positionPreview:null}),o(e)},onDragEnd:function(e){return this.setState({dragging:!1}),o(e)},onDrop:function(e,t){var n=u(t),r=n.path,a=JSON.parse(t.dataTransfer.getData("text"));return 0!==this.props.path.indexOf(r)&&e(f.moveNode(a.path,this.props.path,this.state.positionPreview)),this.setState({positionPreview:null}),o(t)},onDelete:function(e,t){return e(f.deleteNode(this.props.path)),o(t)}})},{"./actions":2,react:"react","react-dom":"react-dom","react-redux":"react-redux"}],4:[function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function a(e){return e&&e.__esModule?e:{"default":e}}function o(){var e=arguments.length<=0||void 0===arguments[0]?[]:arguments[0],t=arguments[1];switch(t.type){case c.INSERT_NODE:return e;case c.DELETE_NODE:return e.deleteIn(t.path.split("."));case c.MOVE_NODE:var n=t.position,r=t.fromPath.split("."),a=t.toPath.split("."),o=e.getIn(r);return e=e.setIn(r,null),n==c.MovePositions.ADOPT?e=e.updateIn(a,function(e){return e.has("children")?e.update("children",function(e){return e.unshift(o)}):e.set("children",s["default"].List([o]))}):!function(){var t=parseInt(a.pop())+(n==c.MovePositions.BEFORE)?0:1;e=e.updateIn(a,function(e){return e.splice(t,0,o)})}(),e.update(d);case c.CHANGE_NODE_TITLE:return e;default:return e}}Object.defineProperty(n,"__esModule",{value:!0});var i=e("redux"),u=e("immutable"),s=a(u),l=e("./actions"),c=r(l),d=function p(e){return e.filter(function(e){return null!==e}).map(function(e){return e.has("children")?e.update("children",p):e})};n["default"]=(0,i.combineReducers)({nodes:o})},{"./actions":2,immutable:"immutable",redux:"redux"}]},{},[1]);